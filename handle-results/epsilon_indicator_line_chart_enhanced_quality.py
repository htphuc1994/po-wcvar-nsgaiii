import matplotlib.pyplot as plt
from matplotlib.lines import Line2D
import numpy as np
import pandas as pd
from matplotlib.font_manager import FontProperties

# experiment 19
# front_num_Array = [9, 10, 7, 7, 6, 5, 5, 5, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# n_nds_Array = [17, 8, 9, 13, 9, 11, 12, 14, 16, 15, 14, 22, 21, 23, 26, 31, 34, 45, 50, 48, 52, 71, 73, 79, 80, 84, 84, 85, 87, 90, 90, 86, 89, 91, 94, 92, 84, 88, 94, 96, 98, 102, 99, 100, 99, 101, 106, 84, 85, 86, 92, 71, 73, 75, 77, 75, 77, 78, 75, 80, 81, 83, 84, 83, 84, 84, 88, 90, 90, 91, 91, 90, 92, 96, 96, 98, 101, 101, 102, 104, 103, 104, 105, 108, 113, 116, 117, 118, 119, 119, 121, 122, 120, 122, 123, 123, 124, 124, 124, 126, 126, 127, 126, 128, 127, 127, 127, 127, 127, 115, 116, 116, 118, 121, 120, 120, 120, 113, 117, 120, 120, 121, 121, 126, 125, 125, 127, 128, 129, 129, 130, 132, 133, 132, 135, 135, 138, 140, 141, 142, 144, 144, 143, 143, 144, 145, 145, 145, 148, 148, 147, 145, 145, 145, 145, 145, 147, 150, 151, 155, 155, 157, 157, 159, 159, 159, 160, 160, 160, 160, 161, 161, 162, 164, 161, 163, 163, 164, 165, 164, 159, 160, 161, 162, 162, 162, 161, 161, 161, 162, 162, 162, 161, 161, 161, 161, 161, 162, 162, 162]
# eps = [None, 0.3961055587, 0.2042355452, 0.2088690487, 0.0655642721, 0.1193923811, 0.0792111634, 0.0146547379, 0.4587167239, 0.0369278838, 0.0429890816, 0.0654962171, 0.025649776, 0.0453410815, 0.0179255295, 0.1327777797, 0.06954151, 0.0081785055, 0.0043403291, 0.0217819657, 0.0196600411, 0.0560261879, 0.0941303464, 0.0037203719, 0.0160160041, 0.007838023, 0.0341942193, 0.1255396431, 0.1113350944, 0.0188786536, 0.0195722503, 0.0473855608, 0.1845166886, 0.616160924, 0.0106988839, 0.0702773653, 0.0181703895, 0.0504407289, 0.0129258849, 0.0155194248, 0.0225569589, 0.0163638419, 0.0204901662, 0.010008019, 0.0077693479, 0.0667269873, 0.2285608201, 0.1667890081, 0.0063978404, 0.0124287582, 0.0503614545, 0.16866712, 0.0074306778, 0.0225415665, 0.0175126524, 0.03646152, 0.0429844631, 0.0377724078, 0.0511523259, 0.175451083, 0.2127843229, 0.0092742264, 0.0026414714, 0.0062749808, 0.0046143838, 0.0063146048, 0.0057889331, 0.0549387521, 0.0119998419, 0.0029139408, 0.0029224566, 0.0504451411, 0.1675027117, 0.007378291, 0.0048070078, 0.0335433655, 0.0068854543, 0.0038671051, 0.0046458161, 0.0100699595, 0.0059019995, 0.0080728177, 0.0057713824, 0.0052112808, 0.0052087073, 0.0193029496, 0.0025104723, 0.0043865413, 0.0021860316, 0.0053261677, 0.0453560957, 0.0099780586, 0.0059897958, 0.0031015777, 0.0043844582, 0.0036114606, 0.0060099204, 0.0043298475, 0.0037336331, 0.0030955475, 0.001848134, 0.0031207545, 0.0010921866, 0.0033049, 0.0065681961, 0.0016123838, 0.0029949313, 0.0017574683, 0.0101163408, 0.0298034448, 0.0102232741, 0.006432718, 0.0069990096, 0.0067865675, 0.0054908979, 0.0036552463, 0.0124621362, 0.0274619557, 0.0254130171, 0.0077666715, 0.0126721184, 0.0028077728, 0.0555972189, 0.0244019659, 0.0040989036, 0.0036731335, 0.0049797601, 0.0057884961, 0.0036881001, 0.0365576348, 0.0255480992, 0.0754542042, 0.0036395122, 0.0015663941, 0.0183034617, 0.0038564547, 0.0056776217, 0.0488162564, 0.0030634697, 0.0036324179, 0.0030883259, 0.0075446609, 0.0037846346, 0.0032588055, 0.0071159171, 0.0031862664, 0.0029572035, 0.0280064416, 0.0022979084, 0.0038394979, 0.011263379, 0.0029740062, 0.0027756095, 0.0034379, 0.002871197, 0.0025582625, 0.0031599723, 0.0017121622, 0.0048043827, 0.0063862133, 0.0022058516, 0.0027364255, 0.0014541371, 0.0037948113, 0.0023176978, 0.0037544568, 0.0012968953, 0.0025710944, 0.0015761854, 0.0024321404, 0.003268014, 0.0021468915, 0.0031336018, 0.0015254567, 0.0024168973, 0.0038736987, 0.0022184896, 0.0033445224, 0.0022405069, 0.0035207531, 0.0044271296, 0.0040613835, 0.0022024384, 0.0045550304, 0.0025014672, 0.0031506792, 0.0016756049, 0.0028752902, 0.0009977305, 0.0028457496, 0.0008549847, 0.0021198019, 0.0030422828, 0.0008720155, 0.0020007011, 0.00289554, 0.0006351794, 0.0018311249, 0.0023653495, 0.0038309498]
# indicators = ['-', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'f', 'ideal', 'ideal', 'f', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'ideal', 'ideal', 'nadir', 'nadir', 'nadir', 'nadir', 'ideal', 'nadir', 'nadir', 'f', 'nadir', 'ideal', 'nadir', 'ideal', 'f', 'nadir', 'nadir', 'ideal', 'f', 'f', 'nadir', 'nadir', 'ideal', 'f', 'nadir', 'nadir', 'ideal', 'ideal', 'nadir', 'nadir', 'nadir', 'nadir', 'nadir', 'ideal', 'nadir', 'nadir', 'f', 'ideal', 'nadir', 'f', 'nadir', 'f', 'nadir', 'nadir', 'nadir', 'nadir', 'nadir', 'nadir', 'f', 'f', 'nadir', 'f', 'f', 'f', 'nadir', 'ideal', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'nadir', 'nadir', 'ideal', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'ideal', 'f', 'f', 'f', 'ideal', 'ideal', 'f', 'f', 'f', 'f', 'f', 'f', 'ideal', 'ideal', 'nadir', 'f', 'nadir', 'nadir', 'nadir', 'nadir', 'f', 'f', 'f', 'f', 'ideal', 'nadir', 'nadir', 'nadir', 'f', 'f', 'nadir', 'ideal', 'f', 'nadir', 'f', 'nadir', 'f', 'nadir', 'nadir', 'f', 'nadir', 'f', 'f', 'nadir', 'f', 'f', 'ideal', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'ideal', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'ideal', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f']
# convergence_eps = 0.005
# investment_period = 3

# experiment 10
# front_num_Array = [9, 6, 7, 6, 6, 5, 5, 5, 4, 3, 3, 3, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# n_nds_Array = [8, 9, 8, 10, 12, 16, 11, 9, 12, 16, 16, 13, 14, 15, 25, 31, 39, 69, 74, 81, 93, 97, 95, 103, 106, 107, 104, 108, 99, 98, 104, 108, 110, 106, 112, 116, 118, 121, 113, 120, 118, 121, 123, 125, 125, 126, 131, 120, 127, 132, 121, 128, 126, 126, 125, 125, 124, 127, 127, 126, 127, 130, 116, 121, 125, 126, 128, 126, 126, 127, 125, 127, 129, 129, 130, 130, 131, 132, 133, 134, 129, 133, 133, 134, 135, 137, 136, 137, 138, 138, 140, 141, 141, 141, 141, 139, 133, 136, 139, 140, 143, 147, 149, 152, 154, 154, 154, 155, 155, 155, 155, 156, 156, 158, 158, 158, 158, 157, 157, 159, 160, 160, 159, 158, 159, 159, 159, 159, 159, 158, 160, 160, 160, 161, 162, 160, 162, 161, 162, 163, 163, 161, 161, 162, 160, 160, 158, 158, 161, 160, 160, 160, 161, 162, 162, 161, 161, 162, 163, 162, 162, 162, 163, 162, 162, 163, 163, 162, 163, 163, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 163, 163, 163, 163, 163, 163, 164, 163, 163, 164, 165, 165, 165, 164, 164, 164, 163, 163, 163]
# eps = [None, 0.2991409137, 0.1414544766, 0.03565045, 0.0389225701, 0.0545167977, 0.3774325374, 0.0239984371, 0.08160263, 0.5994205516, 0.042140507, 0.0223832889, 0.0144322804, 0.1800296839, 0.0101785528, 0.0538243554, 0.0344972115, 0.091272485, 0.0356850226, 0.0344554781, 0.0313495377, 0.0808129619, 0.0149255155, 0.0030723018, 0.0529092287, 0.0187632463, 0.0111033076, 0.00291824, 0.0100258798, 0.023289337, 0.0069154084, 0.0170533066, 0.2562053592, 0.0043175411, 0.2719099804, 0.049091641, 0.010335269, 0.0120502705, 0.0104432023, 0.0479803318, 0.0025915653, 0.0161403353, 0.011689536, 0.0183156253, 0.0095840876, 0.0343168774, 0.0087309333, 0.0366487922, 0.0027813864, 0.0357329095, 0.0329224813, 0.0125383106, 0.0181726533, 0.0152088508, 0.0569415765, 0.0097583225, 0.0233848929, 0.014250715, 0.0028623034, 0.0205699054, 0.00794882, 0.0031444016, 0.0059111386, 0.0082642332, 0.0100530361, 0.0812844717, 0.0088827719, 0.0512240295, 0.0076304786, 0.0052261649, 0.052484994, 0.0069712807, 0.0073565307, 0.0048447892, 0.0054748432, 0.0026152745, 0.6916390432, 0.0027211393, 0.0025764914, 0.239135496, 1.5693424675, 0.0027410295, 0.0059839938, 0.0049519604, 0.0092128345, 0.0104193923, 0.0241757316, 0.0081560517, 0.0047885593, 0.002469758, 0.0025104084, 0.0207952378, 0.0018905506, 0.0047008419, 0.0179448003, 0.0182727002, 0.0045355872, 0.0044551203, 0.0056289227, 0.0047553552, 0.003921782, 0.0051048697, 0.0045262137, 0.1688727789, 0.0044975689, 0.003690502, 0.0047655501, 0.0035451804, 0.002488894, 0.0047817046, 0.0014517067, 0.0060598888, 0.0021939683, 0.0057460129, 0.0029931373, 0.0013664048, 0.0030824308, 0.0015470229, 0.0116898273, 0.0020089241, 0.0034530655, 0.0009860394, 0.0025967862, 0.0019988572, 0.0030457573, 0.0022664181, 0.0059606552, 0.0006048956, 0.0012733478, 0.004560742, 0.0013690146, 0.0017416163, 0.0032513172, 0.0012356936, 0.0049619252, 0.0010626296, 0.0027657286, 0.000604289, 0.0045816376, 0.0011979724, 0.0027746185, 0.0009514867, 0.0018474627, 0.0029471353, 0.0009334545, 0.0024037812, 0.0037253573, 0.0018312707, 0.0142451215, 0.001099373, 0.0018328893, 0.0021716105, 0.0026929278, 0.0020313833, 0.0031842683, 0.0015181932, 0.0025724341, 0.0013835149, 0.0024058779, 0.0032517134, 0.0015846946, 0.0021547948, 0.0029465478, 0.0040948993, 0.0008871474, 0.0019307387, 0.0027111302, 0.0006374674, 0.0012463646, 0.0023166343, 0.0036854777, 0.0102097859, 0.0054262966, 0.0008057252, 0.001973118, 0.0025555033, 0.00606319136, 0.000510942, 0.0011016083, 0.0015416867, 0.0018239828, 0.0020013065, 0.0028362489, 0.0003664775, 0.0008591034, 0.001815276, 0.0019151228, 0.0053710416, 0.0004384172, 0.0007516898, 0.0016301919, 0.002042672, 0.002609703, 0.0001892585, 0.0041435425, 0.0005321002, 0.0013539553, 0.0019921722, 0.0024563731, 0.0028902627]
# indicators = ['-', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'nadir', 'nadir', 'f', 'ideal', 'nadir', 'ideal', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'f', 'nadir', 'ideal', 'nadir', 'nadir', 'ideal', 'f', 'ideal', 'nadir', 'ideal', 'nadir', 'f', 'ideal', 'f', 'nadir', 'f', 'ideal', 'nadir', 'ideal', 'ideal', 'ideal', 'ideal', 'nadir', 'nadir', 'nadir', 'ideal', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'nadir', 'nadir', 'f', 'nadir', 'f', 'nadir', 'f', 'f', 'nadir', 'f', 'f', 'ideal', 'f', 'ideal', 'nadir', 'f', 'f', 'nadir', 'nadir', 'ideal', 'f', 'f', 'ideal', 'ideal', 'nadir', 'nadir', 'f', 'f', 'ideal', 'nadir', 'f', 'nadir', 'nadir', 'nadir', 'ideal', 'ideal', 'ideal', 'f', 'ideal', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'nadir', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'ideal', 'f', 'f', 'f', 'f', 'f', 'f', 'nadir', 'f', 'f', 'f', 'f', 'f']
# convergence_eps = 0.01
# investment_period = 6


# experiment 13
front_num_Array = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
n_nds_Array = [17, 8, 7, 6, 10, 7, 11, 17, 17, 15, 20, 27, 16, 21, 25, 30, 29, 31, 23, 24, 26, 16, 19, 26, 30, 26, 35, 22, 9, 29, 17, 13, 23, 29, 22, 26, 23, 18, 22, 22, 27, 28, 27, 39, 22, 24, 25, 25, 28, 27, 29, 29, 19, 30, 32, 36, 29, 18, 20, 34, 28, 31, 20, 14, 8, 8, 3, 6, 7, 8, 5, 4, 4, 5, 13, 9, 4, 4, 8, 6, 8, 6, 6, 11, 11, 6, 9, 11, 13, 14, 17, 15, 29, 27, 25, 31, 24, 24, 28, 29, 35, 37, 36, 39, 40, 37, 44, 34, 39, 45, 25, 25, 44, 43, 47, 35, 39, 39, 33, 33, 29, 28, 39, 46, 34, 50, 42, 47, 47, 52, 38, 40, 42, 46, 51, 42, 40, 35, 39, 38, 46, 52, 43, 45, 46, 36, 30, 33, 29, 26, 33, 36, 39, 27, 32, 30, 29, 45, 44, 24, 35, 38, 42, 36, 38, 40, 30, 23, 25, 24, 29, 39, 28, 27, 26, 34, 24, 40, 35, 31, 45, 41, 44, 49, 29, 31, 27, 25, 45, 37, 42, 39, 48, 43, 47, 58, 47, 31, 33, 14]
eps = [None, 1.0046262616, 0.4035052353, 0.265379487, 0.2264965076, 0.0963034882, 0.1080429107, 0.2212287195, 0.3920492687, 0.2141007672, 0.1934561207, 0.2245550347, 0.0083685517, 0.075490998, 0.022383045, 0.1888231757, 0.0079669954, 0.0640847174, 0.182289943, 0.0254350734, 0.0613772903, 0.1240329462, 0.2300927598, 0.1081174452, 0.103358491, 0.0900458138, 0.1006680945, 0.073490235, 0.1798288814, 0.0659454579, 0.0606867953, 0.0646054826, 0.1142154486, 0.1025075076, 0.0362102366, 0.0152071449, 0.3714285954, 0.0791789468, 0.0610038178, 0.0714025493, 0.0492435732, 0.009028646, 0.0523241888, 0.0048053765, 0.0364722059, 0.0236235487, 0.0320495542, 0.0452255464, 0.024538034, 0.0591218573, 0.0249926575, 0.028782058, 0.0960500817, 0.1016608873, 0.0213925564, 0.0537424069, 0.0414553405, 0.0949096365, 0.0431759207, 0.0409187314, 0.065113957, 0.0899652862, 0.1190764826, 0.1470701728, 0.4207618989, 0.1126179903, 0.628473277, 0.1653409137, 0.1163210888, 0.005868684, 0.0618956888, 0.0139866111, 0.0538393508, 0.1053333182, 0.0823152406, 0.049575142, 0.3429710055, 0.0, 0.0607572519, 0.221963454, 0.0947884892, 0.4513071895, 0.4788092919, 0.1002904246, 0.0443311954, 0.3022139498, 0.1780148348, 0.0340408974, 0.273974453, 0.0778803501, 0.0365665664, 0.0302435282, 0.0773413019, 0.0838243894, 0.0824073379, 0.0463207321, 0.0219744265, 0.0127210952, 0.0218947905, 0.0254785554, 0.0053593707, 0.0285507544, 0.0067386219, 0.0175659679, 0.0089708529, 0.0149644406, 0.0055580989, 0.0414527943, 0.0082979787, 0.0068363552, 0.0243112669, 0.0479338918, 0.0201719016, 0.0188099858, 0.0072122859, 0.0060590914, 0.0058041767, 0.0097405082, 0.0127806974, 0.0060516727, 0.0223818535, 0.1375309094, 0.0247615064, 0.005838333, 0.0442249241, 0.0507936334, 0.0030805916, 0.0111620734, 0.0110388569, 0.0111620734, 0.0104258475, 0.0093899476, 0.0425525603, 0.0328179529, 0.0106217327, 0.0080096622, 0.0177633335, 0.0038248251, 0.0072010076, 0.0111014712, 0.0151626066, 0.0145108325, 0.0178147154, 0.0609863854, 0.0574808369, 0.0625501025, 0.0068833393, 0.8811892346, 0.0025536339, 0.0609863854, 0.0133887795, 0.021863586, 0.0242033312, 0.0703283512, 0.0584196686, 0.0620442746, 0.0123061245, 0.0584196686, 0.0469827508, 0.0263181852, 0.0825499378, 0.0133492328, 0.0131733783, 0.0133492328, 0.0650697602, 0.0610943645, 0.0298169778, 0.3215102887, 0.2432900383, 0.023213531, 0.1599077401, 0.0226684249, 0.0166745285, 0.0170467213, 0.0137692054, 0.0088532384, 0.0506164421, 0.0144351088, 0.0133537137, 0.0574745362, 0.029065285, 0.0299353649, 0.0156620368, 0.0136165104, 0.0138044793, 0.0074848758, 0.0253426481, 0.0220454244, 0.0239397773, 0.0248946228, 0.0214741793, 0.0335052277, 0.0138392501, 0.0118172686, 0.0149837632, 0.0105328578, 0.0117548155, 0.0106449799, 0.0103087713, 0.0883613391]
indicators = ['-', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'f', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'nadir', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal', 'ideal']
convergence_eps = 0.1
investment_period = 12


# Prepare data
n_gen = list(range(1, 201))
eps = [float('nan') if v is None else v for v in eps]
eps_array = np.array(eps)

# Optional: smooth trend line
window = 10
rolling_eps = pd.Series(eps_array).rolling(window, min_periods=1).mean()
colors_plate = ["#FFB000", "#FF3030", "#FF33CC", "#C000FF", "#00E5FF", "#00FFBF"]

# Plotting
plt.figure(figsize=(21, 7))

# Main epsilon line
plt.plot(n_gen, eps_array, linestyle='-', color=colors_plate[3], alpha=0.4, label='Raw Epsilon Indicator')

# Smoothed line (moving average)
plt.plot(n_gen, rolling_eps, linestyle='-', color=colors_plate[4], linewidth=2, label=f'{window}-gen Moving Average')



# Scatter points by category
color_map = {'-': 'gray', 'ideal': colors_plate[1], 'f': colors_plate[0], 'nadir': colors_plate[2]}
marker_map = {'ideal': 'o', 'f': 'p', 'nadir': 'h', '-': 'x'}
for i in range(len(n_gen)):
    if not np.isnan(eps[i]):
        marker = marker_map.get(indicators[i], 'o')

        size_map = {'ideal': 8, 'f': 14, 'nadir': 14, '-': 14}
        plt.plot(n_gen[i], eps[i], marker=marker, color=color_map[indicators[i]], linestyle='None', markersize=size_map.get(indicators[i], 10))
        # plt.plot(n_gen[i], eps[i], marker=marker, color=color_map[indicators[i]], linestyle='None')

# Add convergence threshold line
plt.axhline(y=convergence_eps, color='red', linestyle='--', linewidth=1.5, label='Convergence Threshold')

# Set y-axis to log scale
plt.yscale('log')


# Labels and formatting
plt.xlabel('Generation', fontsize=24)
plt.ylabel('Epsilon Indicator (Logarithmic Scale)', fontsize=24)
# plt.title(f'Epsilon Indicator Trajectory Across Generations (Logarithmic Scale) for a {investment_period}-Month Investment Period', fontsize=24)
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.tick_params(axis='both', labelsize=24)

# Custom legend
custom_lines = [
    Line2D([0], [0], color=colors_plate[3], linestyle='-', label='Raw Epsilon Indicator'),
    Line2D([0], [0], color=colors_plate[4], linestyle='-', linewidth=2, label='Moving Average'),
    Line2D([0], [0], color='red', linestyle='--', label='Convergence Threshold'),
    Line2D([0], [0], color=colors_plate[1], marker='o', linestyle='None', label='Ideal Point', markersize=14),
    Line2D([0], [0], color=colors_plate[0], marker='p', linestyle='None', label='F Point', markersize=14),
    Line2D([0], [0], color=colors_plate[2], marker='h', linestyle='None', label='Nadir Point', markersize=14)
]


# Bold tick labels on both axes
# for label in plt.gca().get_xticklabels():
#     label.set_fontweight('bold')
# for label in plt.gca().get_yticklabels():
#     label.set_fontweight('bold')

# bold_font = FontProperties(weight='bold', size=24)
# plt.legend(handles=custom_lines, loc='upper right', prop=bold_font)
bold_font = FontProperties(size=24)
plt.legend(
    handles=custom_lines,
    prop=bold_font,
    loc='center left',
    bbox_to_anchor=(1.02, 0.5),
    borderaxespad=0,
    frameon=False
)
plt.tight_layout(rect=[0, 0, 0.85, 1])

plt.tight_layout()
plt.show()